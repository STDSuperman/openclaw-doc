---
title: "é…ç½®æ–‡ä»¶è¯´æ˜"
category: "é…ç½®ä¸è¿ç»´"
difficulty: "è¿›é˜¶"
estimated_time: "20åˆ†é’Ÿé˜…è¯»"
tags:
  - é…ç½®
  - openclaw.json
  - JSON5
  - Schema
prerequisites:
  - "[å·²å®Œæˆå®‰è£…](../00-å¿«é€Ÿå¼€å§‹/02-5åˆ†é’Ÿå®‰è£…æŒ‡å—.md)"
  - "[å·²å®Œæˆå‘å¯¼é…ç½®](../00-å¿«é€Ÿå¼€å§‹/03-å‘å¯¼å¼é…ç½®.md)"
related_docs:
  - ["å¿«é€Ÿé…ç½®ç¤ºä¾‹", "å®Œæ•´é…ç½®å‚è€ƒ"]
next_steps:
  - ["å¿«é€Ÿé…ç½®ç¤ºä¾‹", "å®Œæ•´é…ç½®å‚è€ƒ", "Gatewayè¿ç»´"]
last_updated: "2026-02-01"
source: "docs/gateway/configuration.md, docs/gateway/configuration-examples.md"
---

# é…ç½®æ–‡ä»¶è¯´æ˜

> **TL;DR**: OpenClaw çš„é…ç½®æ–‡ä»¶æ˜¯ `~/.openclaw/openclaw.json`ï¼ˆæ”¯æŒ JSON5ï¼‰ï¼ŒåŒ…å«æ‰€æœ‰ç³»ç»Ÿè®¾ç½®ã€‚

<ai-only>
**AI æŒ‡ä»¤åŒº**ï¼šæœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ OpenClaw é…ç½®æ–‡ä»¶çš„ç»“æ„ã€å¿…éœ€å­—æ®µå’Œå¸¸è§é…ç½®é¡¹ï¼Œä¾› AI ç†è§£å’ŒååŠ©ç”¨æˆ·é…ç½®ã€‚
</ai-only>

## é…ç½®æ–‡ä»¶ä½ç½®

### é»˜è®¤è·¯å¾„

| æ“ä½œç³»ç»Ÿ | é…ç½®è·¯å¾„ | è¯´æ˜ |
|---------|----------|------|
| **macOS / Linux** | `~/.openclaw/openclaw.json` | ç”¨æˆ·ä¸»ç›®å½•ä¸‹ |
| **Windows (WSL2)** | `~/.openclaw/openclaw.json` | WSL2 ä¸­ |

### ç¯å¢ƒå˜é‡æ–¹å¼

```bash
# é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®æŸäº›é…ç½®é¡¹
export OPENCLAW_CONFIG_PATH="/custom/path/openclaw.json"
export ANTHROPIC_API_KEY="sk-ant-xxx"
export OPENAI_API_KEY="sk-proj-xxx"
```

**ä¼˜å…ˆçº§**ï¼šç¯å¢ƒå˜é‡ > é…ç½®æ–‡ä»¶ > é»˜è®¤å€¼

---

## é…ç½®æ–‡ä»¶ç»“æ„

### æ ¹çº§åˆ«é…ç½®é¡¹

```json5
{
  // ========== ç½‘å…³é…ç½® ==========
  gateway: {
      port: 18789,  // Gateway ç›‘å¬ç«¯å£
      bind: "loopback",  // ç»‘å®šåœ°å€
      auth: {
        token: "å®‰å…¨ä»¤ç‰Œ",  // Gateway è®¤è¯ä»¤ç‰Œ
        mode: "token"  // è®¤è¯æ¨¡å¼
      },
      tailscale: {
        mode: "off"  // Tailscale æ¨¡å¼
      }
  },
  
  // ========== æ¨¡å‹é…ç½® ==========
  models: {
      providers: {
        anthropic: {
          apiKey: "$ANTHROPIC_API_KEY",  // Anthropic API Key
          baseUrl: "è‡ªå®šä¹‰ API åœ°å€",  // å¯é€‰
          region: "us-east-1"  // å¯é€‰
        },
        openai: {
          apiKey: "$OPENAI_API_KEY",  // OpenAI API Key
          organization: "ç»„ç»‡ ID",  // å¯é€‰
          baseUrl: "è‡ªå®šä¹‰ API åœ°å€"  // å¯é€‰
        }
      },
      defaultModel: "anthropic/claude-opus-4-5"  // é»˜è®¤æ¨¡å‹
  },
  
  // ========== æ™ºèƒ½ä½“é…ç½® ==========
  agents: {
      defaults: {
        workspace: "~/.openclaw/workspace",  // å·¥ä½œç©ºé—´è·¯å¾„
        model: "anthropic/claude-opus-4-5",  // é»˜è®¤æ¨¡å‹
        sandbox: {
          mode: "non-main"  // æ²™ç›’æ¨¡å¼
        },
        temperature: 1.0,  // æ¸©åº¦ (0-2)
        maxTokens: 8192  // æœ€å¤§ Token æ•°
      }
  },
  
  // ========== æ¶ˆæ¯é€šé“é…ç½® ==========
  channels: {
      whatsapp: {
        allowFrom: [],  // å…è®¸åˆ—è¡¨ï¼ˆç”µè¯å·ç ï¼‰
        groups: {
          "*": {
            requireMention: true  // ç¾¤ç»„éœ€è¦@æåŠ
          }
        }
      },
      telegram: {
        botToken: "$TELEGRAM_BOT_TOKEN",
        allowFrom: [],  // é»˜è®¤ç©ºï¼ˆæ‰€æœ‰ç”¨æˆ·ï¼‰
        groups: {
          "*": {
            requireMention: true
          }
        }
      },
      discord: {
        token: "$DISCORD_BOT_TOKEN",
        allowFrom: [],  // é»˜è®¤ç©º
        guilds: {
          "*": {
            requireMention: true
          }
        }
      }
  },
  
  // ========== ä¼šè¯é…ç½® ==========
  session: {
      defaultModel: "anthropic/claude-opus-4-5",  // é»˜è®¤æ¨¡å‹
      maxMessages: 100,  // æ¯ä¸ªä¼šè¯æœ€å¤§æ¶ˆæ¯æ•°
      compactThreshold: 80,  // å‹ç¼©é˜ˆå€¼
      idleTimeout: 1800,  // é—²ç½®è¶…æ—¶ï¼ˆç§’ï¼‰
      autoCompact: true,  // è‡ªåŠ¨å‹ç¼©
  },
  
  // ========== æ¶ˆæ¯é…ç½® ==========
  messages: {
      messagePrefix: "",  // æ¶ˆæ¯å‰ç¼€
      responsePrefix: "",  // å“åº”å‰ç¼€
      ackReaction: "ğŸ‘"  // ç¡®è®¤è¡¨æƒ…
      ackReactionScope: "group-mentions"  // ç¡®è®¤ä½œç”¨åŸŸ
  },
  
  // ========== å·¥å…·é…ç½® ==========
  tools: {
      web: {
        search: {
          apiKey: "$BRAVE_SEARCH_API_KEY",  // Brave Search API Key
          provider: "brave"  // æœç´¢æä¾›å•†
        }
      },
      media: {
        audio: {
          enabled: true,  // å¯ç”¨éŸ³é¢‘è½¬å½•
          model: "openai/whisper-1",  // è½¬å½•æ¨¡å‹
          maxBytes: 2097152  // æœ€å¤§ 2MB
        }
      }
  },
  
  // ========== è·¯ç”±é…ç½® ==========
  routing: {
      agents: {},  // æ™ºèƒ½ä½“åˆ—è¡¨
      bindings: [],  // ç»‘å®šè§„åˆ™
      defaultAgent: "main",  // é»˜è®¤æ™ºèƒ½ä½“
  },
  
  // ========== å®‰å…¨é…ç½® ==========
  security: {
      pairing: {
        approveLocal: true,  // è‡ªåŠ¨æ‰¹å‡†æœ¬åœ°è¿æ¥
        timeout: 300  // é…å¯¹è¶…æ—¶ï¼ˆç§’ï¼‰
      },
      sandbox: {
        mode: "non-main"  // æ²™ç›’æ¨¡å¼
      }
  }
}
```

---

## å…³é”®é…ç½®é¡¹è¯¦è§£

### Gatewayï¼ˆç½‘å…³ï¼‰

#### ç«¯å£å’Œç»‘å®š

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|----------|------|
| `gateway.port` | æ•´æ•° | 18789 | Gateway ç›‘å¬ç«¯å£ |
| `gateway.bind` | å­—ç¬¦ä¸² | "loopback" | ç»‘å®šåœ°å€ |
| `gateway.auth.token` | å­—ç¬¦ä¸² | è‡ªåŠ¨ç”Ÿæˆ | WebSocket è®¤è¯ä»¤ç‰Œ |
| `gateway.auth.mode` | å­—ç¬¦ä¸² | "token" | è®¤è¯æ¨¡å¼ |
| `gateway.tailscale.mode` | å­—ç¬¦ä¸² | "off" | Tailscale æ¨¡å¼ |

**ç»‘å®šæ¨¡å¼è¯´æ˜**ï¼š

| æ¨¡å¼ | è¯´æ˜ | å®‰å…¨æ€§ | é€‚ç”¨åœºæ™¯ |
|------|------|--------|----------|
| `loopback` | ä»…æœ¬åœ°å›ç¯åœ°å€ | ğŸ”’ é«˜ | æœ¬åœ°å¼€å‘ |
| `0.0.0.0` | æœ¬æœºæ‰€æœ‰æ¥å£ | âš ï¸ ä¸­ | æœ¬åœ°æ‰€æœ‰å®¢æˆ·ç«¯ |
| `0.0.0.0` | ç‰¹å®šåœ°å€ï¼ˆVPN/IPï¼‰ | ğŸ”’ é«˜ | ç‰¹å®šç½‘ç»œè®¿é—® |
| `tailnet` | Tailscale ç½‘ç»œ | ğŸ”’ é«˜ | å¤šè®¾å¤‡è®¿é—® |

---

### æ¨¡å‹é…ç½®

#### Anthropic

```json5
{
  "models": {
    "providers": {
      "anthropic": {
        "apiKey": "$ANTHROPIC_API_KEY",
        "baseUrl": "https://api.anthropic.com",  // å¯é€‰
        "region": "us-east-1",  // us-east-1 | us-west-2
        "maxRetries": 3,  // æœ€å¤§é‡è¯•æ¬¡æ•°
        "timeoutMs": 60000  // è¶…æ—¶ 60 ç§’
      }
    },
    "defaultModel": "anthropic/claude-opus-4-5"
  }
}
```

#### OpenAI

```json5
{
  "models": {
    "providers": {
      "openai": {
        "apiKey": "$OPENAI_API_KEY",
        "organization": "ç»„ç»‡ ID",
        "baseUrl": "https://api.openai.com/v1"
      }
    }
  }
}
```

---

### æ¶ˆæ¯é€šé“é…ç½®

#### WhatsApp

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|----------|------|
| `channels.whatsapp.allowFrom` | æ•°ç»„ | [] | å…è®¸çš„å·ç ï¼ˆå¦‚ ["+86138000000"]ï¼‰ |
| `channels.whatsapp.groups.*.requireMention` | å¸ƒå°” | true | ç¾¤ç»„é»˜è®¤éœ€è¦@æåŠ |
| `channels.whatsapp.business` | å­—ç¬¦ä¸² | null | å•†ä¸šè´¦å· ID |
| `channels.whatsapp.webhookUrl` | å­—ç¬¦ä¸² | null | Webhook URL |

#### Telegram

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|----------|------|
| `channels.telegram.botToken` | å­—ç¬¦ä¸² | å¿…éœ€ | Bot Token |
| `channels.telegram.allowFrom` | æ•°ç»„ | [] | å…è®¸çš„ç”¨æˆ· ID |
| `channels.telegram.groups.*.requireMention` | å¸ƒå°” | true | ç¾¤ç»„éœ€è¦@æåŠ |
| `channels.telegram.apiId` | æ•´æ•° | null | API ID |

#### Discord

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|----------|------|
| `channels.discord.token` | å­—ç¬¦ä¸² | å¿…éœ€ | Bot Token |
| `channels.discord.allowFrom` | æ•°ç»„ | [] | å…è®¸çš„ç”¨æˆ·/è§’è‰² ID |
| `channels.discord.guilds.*.requireMention` | å¸ƒå°” | true | é¢‘é“éœ€è¦@æåŠ |

---

### ä¼šè¯é…ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|----------|------|
| `session.maxMessages` | æ•´æ•° | 100 | æ¯ä¸ªä¼šè¯æœ€å¤§æ¶ˆæ¯æ•° |
| `session.compactThreshold` | æ•´æ•° | 80 | è¾¾åˆ°æ­¤æ•°é‡æ—¶è‡ªåŠ¨å‹ç¼© |
| `session.idleTimeout` | æ•´æ•° | 1800 | é—²ç½®è¶…æ—¶ï¼ˆç§’ï¼Œ30 åˆ†é’Ÿï¼‰ |
| `session.autoCompact` | å¸ƒå°” | true | è‡ªåŠ¨å‹ç¼©æ—§æ¶ˆæ¯ |
| `session.prune.toolResults` | å¸ƒå°” | true | æ¸…ç†å·¥å…·ç»“æœ |

---

### å®‰å…¨é…ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|----------|------|
| `security.pairing.approveLocal` | å¸ƒå°” | true | è‡ªåŠ¨æ‰¹å‡†æœ¬åœ°è¿æ¥ |
| `security.pairing.timeout` | æ•´æ•° | 300 | é…å¯¹è¯·æ±‚è¶…æ—¶ï¼ˆ5 åˆ†é’Ÿï¼‰ |
| `security.sandbox.mode` | å­—ç¬¦ä¸² | "non-main" | æ²™ç›’æ¨¡å¼ |
| `security.denylist.enabled` | å¸ƒå°” | false | å¯ç”¨æ‹’ç»åˆ—è¡¨ |

---

## é…ç½®æ–‡ä»¶æœ€ä½³å®è·µ

### 1. å®‰å…¨å»ºè®®

- âœ… **ä½¿ç”¨ç¯å¢ƒå˜é‡**ï¼šä¸è¦åœ¨é…ç½®æ–‡ä»¶ä¸­ç¡¬ç¼–ç  API Key
- âœ… **é™åˆ¶è®¿é—®æƒé™**ï¼šä½¿ç”¨ `allowFrom` ç™½åå•
- âœ… **å¯ç”¨é…å¯¹**ï¼šæœªçŸ¥è®¾å¤‡éœ€è¦é…å¯¹æ‰¹å‡†
- âœ… **æ²™ç›’æ¨¡å¼**ï¼šç¾¤ç»„ä½¿ç”¨ `non-main` æ²™ç›’

### 2. æ€§èƒ½ä¼˜åŒ–

- âœ… **è®¾ç½®åˆç†çš„æ¶ˆæ¯é™åˆ¶**ï¼š`session.maxMessages` é¿å…å†…å­˜æº¢å‡º
- âœ… **å¯ç”¨è‡ªåŠ¨å‹ç¼©**ï¼š`session.autoCompact` èŠ‚çœ Token
- âœ… **è®¾ç½®é—²ç½®è¶…æ—¶**ï¼š`session.idleTimeout` æ¸…ç†ä¸æ´»è·ƒä¼šè¯

### 3. ç»´æŠ¤å»ºè®®

- âœ… **å®šæœŸå¤‡ä»½**ï¼š`cp ~/.openclaw/openclaw.json ~/.openclaw/openclaw.json.backup`
- âœ… **ä½¿ç”¨æ³¨é‡Š**ï¼šJSON5 æ”¯æŒæ³¨é‡Šï¼Œæ–¹ä¾¿ç†è§£
- âœ… **ç‰ˆæœ¬æ§åˆ¶**ï¼šå°†é…ç½®æ–‡ä»¶çº³å…¥ Git ç®¡ç†

---

## é…ç½®éªŒè¯

### ä½¿ç”¨ CLI éªŒè¯

```bash
# éªŒè¯é…ç½®æ–‡ä»¶è¯­æ³•
openclaw doctor

# éªŒè¯æ‰€æœ‰é…ç½®é¡¹
openclaw config validate

# æŸ¥çœ‹å½“å‰é…ç½®
openclaw config get
```

### ä½¿ç”¨ Doctor ä¿®å¤

```bash
# è‡ªåŠ¨ä¿®å¤å¸¸è§é—®é¢˜
openclaw doctor --fix

# æ·±åº¦æ£€æŸ¥
openclaw doctor --deep

# åªæ˜¾ç¤ºé—®é¢˜ï¼Œä¸ä¿®å¤
openclaw doctor
```

---

## é…ç½®æ–‡ä»¶ç¤ºä¾‹

### æœ€å°é…ç½®

```json5
{
  "gateway": {
    "port": 18789
  },
  "agents": {
    "defaults": {
      "model": "anthropic/claude-opus-4-5"
    }
  }
}
```

### ç”Ÿäº§é…ç½®

```json5
{
  "gateway": {
    "port": 18789,
    "bind": "loopback",
    "auth": {
      "token": "your-secure-token-here"
    }
  },
  
  "channels": {
    "whatsapp": {
      "allowFrom": ["+86138000000", "+86138000001"]
    },
    "telegram": {
      "allowFrom": ["@user1", "@user2"]
    }
  },
  
  "session": {
    "maxMessages": 50,
    "compactThreshold": 40,
    "idleTimeout": 3600
  },
  
  "security": {
    "pairing": {
      "approveLocal": true
    },
    "sandbox": {
      "mode": "non-main"
    }
  }
}
```

---

## ä¸‹ä¸€æ­¥æ–‡æ¡£

- [å¿«é€Ÿé…ç½®ç¤ºä¾‹](./01-å¿«é€Ÿé…ç½®ç¤ºä¾‹.md) - å¸¸è§é…ç½®ç¤ºä¾‹
- [å®Œæ•´é…ç½®å‚è€ƒ](./02-å®Œæ•´é…ç½®å‚è€ƒ.md) - æ‰€æœ‰é…ç½®é¡¹è¯¦ç»†è¯´æ˜
- [Gateway è¿ç»´](./03-Gatewayè¿ç»´.md) - Gateway è¿è¡Œå’Œç®¡ç†
- [å®‰å…¨é…ç½®](./06-å®‰å…¨é…ç½®.md) - å®‰å…¨ç­–ç•¥å’Œæœ€ä½³å®è·µ
- [æ•…éšœæ’æŸ¥](./09-æ•…éšœæ’æŸ¥.md) - å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

---

<ai-search-key>
é…ç½®, openclaw.json, JSON5, ç½‘å…³, æ¨¡å‹, æ¶ˆæ¯é€šé“, ä¼šè¯, å®‰å…¨, å·¥å…·, è·¯ç”±, éªŒè¯, æœ€ä½³å®è·µ, ç¯å¢ƒå˜é‡, ç«¯å£, ç»‘å®š, è®¤è¯, æ²™ç›’, é…å¯¹, ç™½åå•
</ai-search-key>

**é…ç½®æ–‡ä»¶è¦ç‚¹æ€»ç»“**ï¼š
- ğŸ“ **ä½ç½®**ï¼š`~/.openclaw/openclaw.json`
- ğŸ”§ **æ ¼å¼**ï¼šJSON5ï¼ˆæ”¯æŒæ³¨é‡Šå’Œå°¾éšé€—å·ï¼‰
- ğŸ”’ **å®‰å…¨**ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨ API Key
- ğŸ“‹ **æ ¸å¿ƒç« èŠ‚**ï¼šGatewayã€æ¨¡å‹ã€é€šé“ã€ä¼šè¯ã€å®‰å…¨
- âœ… **éªŒè¯**ï¼šä½¿ç”¨ `openclaw doctor` æ£€æŸ¥é…ç½®
- ğŸ’¾ **å¤‡ä»½**ï¼šå®šæœŸå¤‡ä»½é…ç½®æ–‡ä»¶

*æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ [æ–‡æ¡£å¯¼èˆª](../00-æ–‡æ¡£å¯¼èˆª.md)*
