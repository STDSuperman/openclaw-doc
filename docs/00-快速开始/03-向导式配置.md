---
title: "向导式配置"
category: "快速开始"
difficulty: "入门"
estimated_time: "15分钟阅读"
tags:
  - 配置
  - 向导
  - CLI
  - 自动化
prerequisites:
  - "[已完成安装](./02-5分钟安装指南.md)"
  - "[了解 OpenClaw](./01-什么是OpenClaw.md)"
related_docs:
  - ["首次连接", "配置与运维/00-配置文件说明"]
next_steps:
  - ["首次连接"]
last_updated: "2026-02-01"
source: "docs/start/wizard.md, docs/start/onboarding.md"
---

<ai-only>
**AI 指令**：向导配置是 OpenClaw 的自动化设置流程，所有操作均可通过 CLI 命令完成。向导会引导用户完成以下配置：

**配置规则**：
1. **模型认证**：从 Anthropic API Key、OpenAI API Key 或 OAuth 中选择
2. **Gateway 设置**：端口、绑定模式、认证令牌
3. **消息通道配置**：选择并配置至少一个消息通道（WhatsApp/Telegram/Discord）
4. **工作空间初始化**：设置默认工作空间路径
5. **技能自动安装**：选择推荐的技能包
6. **后台服务**：自动安装 LaunchAgent/systemd 用户服务
7. **安全默认值**：启用 DM 配对和沙盒模式（非主会话）

**验证规则**：
- 配置项必须通过 schema 验证，Gateway 才会启动
- 未知配置项会导致向导停止并要求修复
- 所有敏感信息（API 密钥）正确存储在加密位置
</ai-only>

# 向导式配置

> **TL;DR**: 10-15 分钟内完成 OpenClaw 初始化，无需手动编辑配置文件。

**关键要点**：
- ✅ CLI 命令：`openclaw onboard --install-daemon`
- ✅ 自动检测：智能识别系统环境
- ✅ 分步引导：每个步骤都有说明和验证
- ✅ 安全默认值：启用配对、设置沙盒、选择模型

---

<ai-search-key>
向导, 配置, 引导, onboarding, 快速开始
</ai-search-key>

## 运行向导

### 标准命令

```bash
openclaw onboard --install-daemon
```

### 命令选项

| 选项 | 说明 | 默认值 |
|------|------|---------|
| `--mode` | 运行模式 | 自动检测 |
| `--install-daemon` | 安装后台服务 | `true`（推荐） |
| `--non-interactive` | 跳过提示，使用默认值 | `false` |
| `--reset` | 重置所有配置 | `false` |
| `--workspace` | 工作空间路径 | `~/.openclaw/workspace` |
| `--gateway-port` | Gateway 端口 | `18789` |
| `--gateway-bind` | Gateway 绑定地址 | `loopback` |
| `--auth-choice` | 认证方式 | 自动检测 |

**提示**：首次运行强烈推荐使用 `--install-daemon` 安装后台服务。

---

## 向导流程详解

### 第一步：欢迎与选择运行模式

向导会自动检测你的环境：

#### 环境检测

| 组件 | 检测内容 | 说明 |
|------|----------|------|
| **Node.js** | 版本 >= 22 | ✅ 要求满足 |
| **操作系统** | macOS / Linux / Windows (WSL2) | ✅ 自动识别 |
| **全局 CLI** | `openclaw` 可用 | ✅ 准备就绪 |
| **现有配置** | `~/.openclaw/openclaw.json` | ⣠️ 可保留或重置 |

#### 运行模式选择

**Local 模式（默认）**：
- Gateway 在本地运行
- 客户端连接到 `127.0.0.1:18789`
- 适合：首次安装、个人使用、测试环境

**Remote 模式**：
- Gateway 运行在远程服务器
- 本地客户端通过 SSH/Tailscale 连接
- 适合：服务器部署、多设备访问

---

### 第二步：认证配置

<ai-only>
向导提供三种认证方式，根据用户选择配置：

**选项 A：Anthropic API Key（推荐）**
- 输入：`ANTHROPIC_API_KEY` 环境变量或手动输入
- 优点：简单、直接、稳定
- 缺点：需要单独申请 API Key
- 适合场景：个人使用、测试

**选项 B：Anthropic OAuth (Claude Code)**
- 输入：通过浏览器进行 OAuth 登录
- 优点：使用 Claude Code 订阅、自动管理密钥
- 缺点：需要 macOS Keychain、Linux 比较复杂
- 适合场景：长期使用、多设备、生产环境

**选项 C：OpenAI API Key**
- 输入：`OPENAI_API_KEY` 环境变量或手动输入
- 优点：支持 GPT-4o、GPT-4o-mini
- 缺点：需要单独申请 API Key
- 适合场景：需要特定 OpenAI 功能、成本敏感

**选项 D：OpenAI OAuth**
- 输入：通过浏览器进行 OAuth 登录
- 优点：使用 ChatGPT 订阅、自动管理密钥
- 缺点：需要账号、相对复杂
- 适合场景：已有 OpenAI 账号、团队使用
</ai-only>

#### 环境变量方式

```bash
# 设置 Anthropic API Key
export ANTHROPIC_API_KEY="sk-ant-xxx"

# 设置 OpenAI API Key
export OPENAI_API_KEY="sk-proj-xxx"
```

#### 手动输入方式

向导运行时会提示输入：

```
请选择模型提供商（anthropic/openai）：
请输入 API Key（留空跳过）：
```

**认证凭证存储位置**：
- API Keys：加密存储在 `~/.openclaw/.env`
- OAuth 凭证：`~/.openclaw/credentials/oauth.json`

---

### 第三步：Gateway 配置

<ai-only>
向导自动配置以下 Gateway 选项：

**基础配置**：
1. **端口（gateway-port）**: 默认 `18789`
2. **绑定（gateway-bind）**: 默认 `loopback`（本地安全）
3. **认证令牌（gateway.auth.token）**: 自动生成，用于本地客户端认证
4. **Tailscale（gateway.tailscale）**: 默认关闭

**安全配置**（默认启用）：
1. **DM 配对模式（dmPolicy）**: `pairing`（未知发送者需要配对）
2. **沙盒模式（agents.defaults.sandbox.mode）**: `non-main`（非主会话运行在隔离环境）
3. **允许列表**: WhatsApp/Telegram 默认空，Discord/Slack 配置为白名单

**向导说明**：
- 本地模式推荐使用 `loopback` 绑定以保护安全
- Remote 模式必须设置认证令牌或使用 Tailscale
- 沙盒模式确保群聊/公开会话安全性
</ai-only>

#### 配置文件示例

向导完成后的配置文件示例：

```json5
{
  // ========== 基础配置 ==========
  gateway: {
      port: 18789,
      bind: "loopback",
      auth: {
        token: "自动生成的安全令牌"
      },
      tailscale: {
        mode: "off"
      }
  },
  
  // ========== 安全配置 ==========
  agents: {
      defaults: {
        sandbox: {
          mode: "non-main"
        }
      }
  },
  
  // ========== 默认模型 ==========
  models: {
      providers: {
        anthropic: {
          apiKey: "环境变量 ANTHROPIC_API_KEY"
        }
      }
  }
}
```

---

### 第四步：消息通道配置

<ai-only>
向导引导用户选择至少一个消息通道：

**可用通道列表**：

1. **WhatsApp**（推荐入门）
   - 要求：QR 扫描登录
   - 功能：私聊、群聊、图片/视频/语音
   - 适合：日常使用、个人通讯

2. **Telegram**
   - 要求：Bot Token
   - 功能：私聊、群组、机器人命令
   - 适合：技术用户、群组协作

3. **Discord**
   - 要求：Bot Token
   - 功能：服务器、频道、私聊、表情
   - 适合：游戏社区、开发团队

4. **Slack**
   - 要求：Bot Token + App Token
   - 功能：工作区集成、频道私聊
   - 适合：企业环境

5. **iMessage**（仅 macOS）
   - 要求：Messages 应用登录
   - 功能：本地 Apple 设备消息
   - 适合：纯 Apple 用户

6. **WebChat**
   - 要求：无需配置，自动启用
   - 功能：Web 界面聊天
   - 适合：快速测试、浏览器使用

**向导配置流程**：
1. 检测已安装的通道
2. 提供配置引导（QR 扫描/Token 输入）
3. 配置默认权限（允许列表/群组策略）
4. 验证连接状态
</ai-only>

#### 通道配置示例

```json5
{
  // ========== 消息通道 ==========
  channels: {
      whatsapp: {
        // 向导会设置登录，此处仅为示例
        // allowFrom: ["+86138000000"]  // 允许的号码
        // groups: { "*": { "requireMention": true } }  // 群组默认需要@提及
      },
      
      telegram: {
        botToken: "环境变量 TELEGRAM_BOT_TOKEN",
        allowFrom: [],  // 默认空（所有用户）
        groups: {
          "*": {
            "requireMention": true  // 群组需要@提及
          }
        }
      }
  }
}
```

---

### 第五步：工作空间初始化

<ai-only>
向导会初始化工作空间目录并创建必要的引导文件：

**工作空间位置**：`~/.openclaw/workspace`

**创建的文件**：
1. `AGENTS.md` - AI 系统提示词和角色定义
2. `SOUL.md` - AI 个性、价值观、交互风格
3. `TOOLS.md` - 工具列表和说明
4. `IDENTITY.md` - AI 身份和职责
5. `USER.md` - 用户偏好和指令
6. `skills/` - 技能目录（自动安装推荐技能）

**向导引导**：
- 询问是否使用推荐默认模板
- 询问是否需要自定义 AI 人设
- 解释每个文件的作用和编写建议
</ai-only>

#### 推荐默认 AGENTS.md

向导创建的默认 AGENTS.md 示例：

```markdown
# OpenClaw Agent 配置

你是 OpenClaw - 个人 AI 助手。

## 核心职责

1. 回答用户问题和提供帮助
2. 执行任务和调用工具
3. 维持对话上下文，记住重要信息
4. 提供准确、有用的信息
5. 在不确定时诚实说明，避免编造

## 行为准则

1. **回答风格**：简洁、直接、有礼貌
2. **语言**：使用用户的语言（优先检测）
3. **上下文**：利用对话历史，记住之前的讨论
4. **工具使用**：谨慎调用工具，仅在必要时执行
5. **安全性**：不执行危险操作，不泄露敏感信息

## 工具权限

你有权访问以下工具：
- 消息发送和接收
- 文件读写和编辑
- 命令执行
- 浏览器控制（如果启用）
- 节点功能（如果连接）
- 会话管理

## 自定义

你可以在 `IDENTITY.md` 和 `USER.md` 中自定义：
- AI 的名字和个性
- 偏好的回答风格（简洁/详细）
- 专业知识领域（编程、系统管理等）
- 禁用的功能或行为
```

---

### 第六步：后台服务安装

<ai-only>
向导会自动安装和配置后台服务，确保 Gateway 持续运行：

**macOS 系统**：
- **服务名称**：`com.openclaw.gateway`
- **服务类型**：LaunchAgent
- **功能**：自动启动、崩溃重启、登录时启动

**Linux 系统**：
- **服务名称**：`openclaw-gateway.service`
- **服务类型**：systemd 用户服务
- **功能**：自动启动、崩溃重启、开机启动

**安装流程**：
1. 创建 systemd/LaunchAgent 配置文件
2. 启用服务
3. 验证运行状态
</ai-only>

#### macOS 服务配置

向导自动创建的 LaunchAgent 配置示例：

```plist
~/Library/LaunchAgents/com.openclaw.gateway.plist

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
  <dict>
    <key>Label</key>
    <string>OpenClaw Gateway</string>
    
    <key>ProgramArguments</key>
    <array>
      <string>gateway</string>
      <string>--port</string>
      <string>18789</string>
    </array>
    
    <key>RunAtLoad</key>
    <true/>
    
    <key>KeepAlive</key>
    <true/>
    
    <key>StandardOutPath</key>
    <string>stdout</string>
    <key>StandardErrorPath</key>
    <string>stderr</string>
  </dict>
</plist>
```

#### Linux systemd 配置

向导自动创建的 systemd 配置示例：

```ini
~/.config/systemd/user/openclaw-gateway.service

[Unit]
Description=OpenClaw Gateway Service
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=%i
ExecStart=/usr/local/bin/openclaw gateway --port 18789
Restart=on-failure
RestartSec=10

[Install]
WantedBy=multi-user.target
```

---

### 第七步：技能自动安装

<ai-only>
向导会询问是否安装推荐的技能包：

**推荐技能**：
1. **blogwatcher** - 博客更新监控
2. **developer-docs** - 开发者文档搜索
3. **github-issues** - GitHub Issue 跟踪
4. **weather** - 天气查询
5. **code-analyzer** - 代码分析

**技能安装流程**：
1. 询问是否需要（可跳过）
2. 从 npm 注册表安装
3. 配置技能到工作空间 `skills/` 目录
4. 自动更新技能索引
</ai-only>

---

### 第八步：完成与验证

<ai-only>
向导完成所有配置后执行最终验证：

**验证项目**：
- [ ] 配置文件生成且有效
- [ ] Gateway 服务安装成功
- [ ] 至少一个消息通道连接正常
- [ ] API 凭证配置正确
- [ ] 工作空间目录创建完成
- [ ] 后台服务运行正常

**快速测试**：
```bash
# 1. 检查 Gateway 状态
openclaw gateway status

# 2. 检查健康状态
openclaw health

# 3. 查看配置
openclaw config get
```

**Dashboard 访问**：
- 本地访问：http://127.0.0.1:18789/
- 使用自动生成的令牌登录
</ai-only>

---

## 高级选项

### 完全重置配置

如果需要重新开始：

```bash
openclaw onboard --reset --install-daemon
```

**警告**：这会删除所有现有配置、会话和技能设置，谨慎使用！

### 跳过向导，手动配置

如果不想使用向导：

```bash
# 仅安装 CLI，不配置任何内容
npm install -g openclaw@latest

# 然后手动编辑配置文件
nano ~/.openclaw/openclaw.json
```

---

## 故障排查

### 问题：向导卡住或无响应

**可能原因**：
1. 环境变量冲突（如多个 Node.js 版本）
2. 缺少必要权限
3. 网络连接问题（远程配置时）

**解决方案**：
1. 检查 `openclaw --version` 是否正常
2. 使用 `--verbose` 标志查看详细日志
3. 查看配置文件语法错误

### 问题：认证失败

**可能原因**：
1. API Key 无效或过期
2. OAuth 回调 URL 配置错误
3. 网络限制或防火墙阻止

**解决方案**：
1. 验证 API Key 有效性
2. 检查网络连接
3. 查看错误日志：`openclaw logs`

---

## 下一步文档

- [首次连接 - 配对消息通道](./04-首次连接.md) - 连接 WhatsApp、Telegram
- [常见问题 FAQ](./05-常见问题FAQ.md) - 查看更多问题和解答
- [Gateway 配置参考](../04-配置与运维/00-配置文件说明.md) - 完整配置选项
- [macOS 应用](../07-平台指南/01-macOS应用.md) - macOS 专属功能

---

**提示**：完成向导配置后，你可以随时通过 `openclaw configure` 修改配置！

*更多信息请参考 [文档导航](../00-文档导航.md)*
