---
title: "消息工具"
category: "工具与功能"
difficulty: "beginner"
estimated_time: "10 min"
tags: ["消息", "agent", "CLI", "发送消息"]
prerequisites: ["基础使用", "自动化任务"]
related_docs: ["斜杠命令", "发送消息"]
next_steps: ["斜杠命令"]
last_updated: "2026-01-01"
source: "docs/tools/agent-send.md"
---


# 消息工具

## `openclaw agent` 命令

`openclaw agent` 在不需要入站聊天消息的情况下运行单个 agent 回合。
默认情况下它 **通过 Gateway** 运行;添加 `--local` 以强制在当前机器上使用嵌入式运行时。

## 行为

- 必需: `--message <text>`
- 会话选择:
  - `--to <dest>` 派生会话密钥(组/频道目标保留隔离;直接聊天折叠到 `main`),**或者**
  - `--session-id <id>` 按 id 重用现有会话,**或者**
  - `--agent <id>` 直接定位到已配置的 agent(使用该 agent 的 `main` 会话密钥)
- 运行与正常入站回复相同的嵌入式 agent 运行时
- 思考/详细标志持久化到会话存储
- 输出:
  - 默认: 打印回复文本(加上 `MEDIA:<url>` 行)
  - `--json`: 打印结构化负载 + 元数据
- 可选地通过 `--deliver` + `--channel` 将回复投递回频道(目标格式匹配 `openclaw message --target`)
- 使用 `--reply-channel`/`--reply-to`/`--reply-account` 在不更改会话的情况下覆盖投递

如果 Gateway 不可访问,CLI **回退**到嵌入式本地运行。

## 示例

```bash
openclaw agent --to +15555550123 --message "状态更新"
openclaw agent --agent ops --message "总结日志"
openclaw agent --session-id 1234 --message "总结收件箱" --thinking medium
openclaw agent --to +15555550123 --message "追踪日志" --verbose on --json
openclaw agent --to +15555550123 --message "召唤回复" --deliver
openclaw agent --agent ops --message "生成报告" --deliver --reply-channel slack --reply-to "#reports"
```

## 标志

- `--local`: 本地运行(要求你的 shell 中有模型提供商 API 密钥)
- `--deliver`: 将回复发送到选定的频道
- `--channel`: 投递频道(`whatsapp|telegram|discord|googlechat|slack|signal|imessage`,默认: `whatsapp`)
- `--reply-to`: 投递目标覆盖
- `--reply-channel`: 投递频道覆盖
- `--reply-account`: 投递账户 id 覆盖
- `--thinking <off|minimal|low|medium|high|xhigh>`: 持久化思考级别(仅 GPT-5.2 + Codex 模型)
- `--verbose <on|full|off>`: 持久化详细级别
- `--timeout <seconds>`: 覆盖 agent 超时
- `--json`: 输出结构化 JSON

## 使用场景

### 快速发送消息

当你想要立即与 agent 交互时,而不通过聊天频道:

```bash
openclaw agent --message "帮我生成周报"
```

### 发送到特定会话

如果你有多个活跃的会话(例如不同的群组或频道),你可以定位到特定的会话:

```bash
openclaw agent --session-id 1234 --message "检查这个会话的状态"
```

### 使用特定 Agent

如果你配置了多个 agents(例如一个用于运维,一个用于日常任务),你可以定位到特定的 agent:

```bash
openclaw agent --agent ops --message "执行每日运维检查"
```

### 投递到其他频道

如果你想将回复发送到不同的聊天频道:

```bash
openclaw agent --to +15555550123 --message "状态更新" --deliver --channel telegram
```

### 获取 JSON 输出

对于脚本或自动化,你可能希望结构化输出:

```bash
openclaw agent --message "分析数据" --json
```

### 本地运行(无 Gateway)

如果 Gateway 不可用或者你想离线运行:

```bash
openclaw agent --local --message "本地任务"
```

## 注意事项

1. **会话隔离**: 使用 `--to` 可以在会话中保持组/频道的隔离,而直接聊天消息会折叠到 `main` 会话
2. **Agent 目标**: 使用 `--agent` 直接定位到已配置的 agent
3. **投递控制**: `--deliver` + `--channel` 控制回复的发送位置
4. **持久化**: `--thinking` 和 `--verbose` 标志会在会话中持久化
5. **本地回退**: 如果 Gateway 不可访问,CLI 会自动回退到嵌入式本地运行
